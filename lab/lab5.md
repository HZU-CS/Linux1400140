# Lab5 **系统管理基础**

实验目的：

1. 熟悉用户、设备、进程、日志管理的相关命令和配置文件
2. 并掌握磁盘管理常用命令
3. 掌握利用虚拟机增加新硬盘，使用 fdisk 对磁盘分区操作

实验要求：

1. 了解用户、设备、进程、日志管理基本知识
2. 掌握用户、设备、进程、日志管理相关命令

实验内容：

## 用户管理

通过修改用户管理相关配置文件管理的方式为系统增加用户 hzu888

## 磁盘分区

1. fdisk 查看当前系统硬盘及分区情况，在作业报告中说明当前的磁盘容量，分 区数量、名称和大小，分区挂载点等信息。

   ```shell
   fdisk -l
   ```

2. 显示当前文件系统使用情况，在作业报告说明当前主要文件系统信息及使用 情况（包括主要文件系统名称、挂载点、容量、使用量及百分比等）

   ```shell
   df -h
   ```

3. 添加新硬盘并完成如下操作

   内容：**关闭虚拟机操作系统，添加 1 块硬盘，大小为 5G。开机后查看新硬盘是否成功添加**

   基本步骤

   1. 关机：init 0 
   2. 添加新硬盘：右键单击虚拟机，选择 setting（设置）。在 Add 中按照要求添 加 2 块新硬盘（HardDisk）
   3. 开机后，打开终端。输入命令 fdisk –l 或 ls /dev/sd*查看新硬盘是否添加成 功。

   **对新添加硬盘进行分区**

   内容：将第二块硬盘 sdb 分区（5G），要求分区 1（sdb1）为主分区，类型为 swap（82），大小为 500M；分区 2（sdb2）为主分区，类型为 linux（83），大小为 2G；分区 3 为扩展分区（sdb3），大小为 sdb 所有剩余容量；分区 5 为 逻辑分区，类型为 lvm（8e），大小为 2G。分区后，查看 sdb 新添加所有分区

   基本步骤

   1. 分区命令，以第二块硬盘（/dev/sdb）为例

      ```shell
      fdisk /dev/sdb 
      ```

      进入分区界面后，p 为查看硬盘分区情况，n 为添加分区，d 为删除分区，t 为 修改分区类型，w 为保存退出。其中，主分区标识为 p，扩展分区标识为 e，逻 辑分区标识为 l。分区大小起始值为默认柱面数，大小可采用+500M 或+2G 表示

   2. 对/dev/sdb 分区，大小为 500M，类型为 82（swap 类型），则操作为： p（查看）、n（新建分区）、p（选择分区为主分区）、1（分区号为 1，即 sdb1）、 直接 enter（默认起始柱面数）、+500M（大小）、p（查看）、t（修改类型）、 分区号为 1，类型为 82，p（查看）、w（保存退出）

4. **将 sdb1 作为交换分区，创建相应文件系统后，挂载**

   步骤

   1. 解释 mkswap 命令作用

      ```shell
      mkswap /dev/sdb1
      ```

   2. ```
      swapon /dev/sdb1
      ```

   3. 解释 swapon 命令作用

      ```shell
      swapon –s
      ```

   4. ```shell
      vim /etc/fstab
      ```

      加入：

      ```shell
      /dev/sdb1 swap swap defaults 0 0
      ```

      执行后，解释每个字段含义

   5. ```shell
      mount -a 
      ```

5. **将 sdb2 作为普通分区，创建文件系统 ext4 后，挂载到/mnt/testb2 中，并测试**

   基本步骤

   1. ```shell
      mkfs.ext4 /dev/sdb2
      ```

   2. ```shell
      vim /etc/fstab
      ```

      加入：

      ```shell
      /dev/sdb2 /mnt/testb2 ext4 defaults 0 0 
      ```

   3. ```shell
      mount -a
      ```

   4. ```shell
      df -h
      ```

      执行

   5. 测试：挂载前在/mnt/testb2 中添加文件和目录 file1、dir1，挂载后查看/mnt/testb2 中内容。查看后，添加文件和目录 file2、dir2，卸载后，查看/mnt/testb2中内容。在作业报告中说明测试结果及原因。

      （卸载命令为：umount /mnt/testb2 或 umount /dev/sdb2）

6. 熟练用户管理、设备管理、进程管理、日志管理相关命令